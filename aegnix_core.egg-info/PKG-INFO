Metadata-Version: 2.4
Name: aegnix-core
Version: 0.1.36
Summary: Core primitives for the AEGNIX Swarm Framework
Author: Invictus Insights R&D
License-Expression: MIT
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: cryptography>=42.0.0
Requires-Dist: requests>=2.31.0

# AEGNIX Core

The **AEGNIX Core** library provides the deterministic cryptographic, envelope, and storage primitives used across the entire **AEGNIX Swarm Framework**.

It is the shared backbone that powers:

* **AE SDK** (Atomic Expert local runtime)
* **ABI Service** (Swarm admission, JWT verification, policy enforcement)
* **ABI SDK** (key enrollment + signed audit events)

Core contains **zero networking, zero JWT, zero policy**, and **no AE-specific logic**.
This keeps it portable, auditable, and suitable for cloud, tactical-edge, or air‑gapped defense deployments.

---

## Installation

```bash
pip install -e .
```

Requires Python ≥ 3.10.

---

## What AEGNIX Core Provides

### ✔ Canonical Envelope Model

`Envelope` defines the signed message schema used across the swarm:

* deterministic ordering
* canonical `to_signing_bytes()` representation
* signature + key_id fields
* replay‑safe IDs + timestamps
* optional AAD for encrypted payload integrity

Every AE and ABI implementation signs and verifies envelopes **identically**, ensuring non‑repudiation and cross‑runtime consistency.

---

### ✔ Deterministic Crypto Primitives

AEGNIX Core implements:

* **Ed25519** for deterministic signatures
* **X25519** for ECDH key exchange
* **HKDF** for symmetric key derivation
* **AES‑GCM** for authenticated encryption

Selected for:

* cross‑platform reproducibility
* low‑overhead edge compatibility
* alignment with NIST/DoD crypto guidelines

---

### ✔ Pluggable Storage (SQLite Default)

`SQLiteStorage` provides:

* AE **keyring**
* **replay‑guard** records
* **audit log index**
* **capability table** (Phase 3G)

It acts as the ABI Service's persistent state, while remaining vendor‑neutral for future adapters:

* PostgreSQL
* Cockroach
* AWS DynamoDB
* GCP Spanner
* Air‑gapped file‑based KV stores

---

## Quick Examples

### Envelope Signing

```python
from aegnix_core.envelope import Envelope
from aegnix_core.crypto import ed25519_generate, sign_envelope, verify_envelope

priv, pub = ed25519_generate()

env = Envelope(
    producer="fusion-ae",
    subject="fusion.track",
    payload={"msg": "hello"}
)

env = sign_envelope(env, priv, key_id="ae-key-1")
print("Verified:", verify_envelope(env, pub))
```

### Encryption

```python
from aegnix_core.crypto import (
    x25519_generate,
    derive_key,
    encrypt_payload_json,
    decrypt_payload_json,
)

s_priv, s_pub = x25519_generate()
r_priv, r_pub = x25519_generate()

k_send = derive_key(s_priv, r_pub)
k_recv = derive_key(r_priv, s_pub)

payload = {"data": "classified"}
enc = encrypt_payload_json(payload, k_send, aad_fields={"subject": "demo"})
dec = decrypt_payload_json(enc, k_recv, aad_fields={"subject": "demo"})
```

### Storage

```python
from aegnix_core.storage import SQLiteStorage, KeyRecord

store = SQLiteStorage("abi_state.db")
store.upsert_key(KeyRecord(ae_id="fusion-ae", pubkey_b64="abcd"))
print(store.get_key("fusion-ae"))
```

---

## Architectural Context

AEGNIX Core provides the shared crypto + envelope foundation for the entire swarm.

```plantuml
@startuml
actor AE
actor ABI

rectangle "AEGNIX AE SDK" as AE_SDK
rectangle "AEGNIX ABI Service" as ABI_SVC
rectangle "AEGNIX Core" as CORE

AE --> AE_SDK : sign + encrypt
ABI_SVC --> CORE : verify signatures
AE_SDK --> CORE : crypto + envelope APIs
CORE --> AE_SDK : deterministic primitives
CORE --> ABI_SVC : deterministic primitives
ABI_SVC --> AE : JWT trust (outside Core)
@enduml
```

---

## Design Goals

| Goal                     | Description                                 |
| ------------------------ | ------------------------------------------- |
| **Zero Vendor Lock**     | Runs in cloud, bare metal, containers, SCIF |
| **Deterministic Crypto** | Stable Ed25519 / X25519 primitives          |
| **Modular Storage**      | SQLite default + future pluggable adapters  |
| **Replay Protection**    | Msg‑ID guard inside storage layer           |
| **Audit Ready**          | Canonical envelopes for non‑repudiation     |

---

## Testing

```bash
pytest -v
```

Tests cover:

* Signing / Verification
* Encryption / Decryption
* Storage behavior
* Replay‑guard

---

## Used By

* **AEGNIX ABI Service** → verify signatures, maintain keyring, enforce replay‑guard
* **AEGNIX AE SDK** → envelope construction, signing, encryption
* **AEGNIX ABI SDK** → admission handshake, key management, signed audit events
* **Future UIX Runtime** → introspection + confidence‑score pipelines

---

## License

Repository: `github.com/invictus-insights/aegnix_core`
Author: Invictus Insights R&D
Version: **0.3.8 (Phase 3G — Finalized Role Merge & Capability Sync)**
License: MIT © Invictus Insights LLC
